<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Authentication
		|
	webda.io - v1.0.0-beta.16</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../../assets/css/main.css">
</head>
<body>
<div class="main">
	<header>
		<div class="tsd-page-toolbar">
			<div class="container">
				<div class="table-wrap">
					<div class="table-cell" id="tsd-search" data-index="../../../assets/js/search.json"
					data-base="../../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<ul class="results-priority" style="display:none">
					</ul>
					<a href="../../../index.html" class="title">webda.io - v1.0.0-beta.16</a>
					&emsp;<a href="/pages/Pages/Guides.html" class="title">Guides</a>
					&emsp;<a href="https://github.com/loopingz/webda.io" class="title">GitHub</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
</div>
<div class="tsd-page-title">
	<div class="container">
		<ul class="tsd-breadcrumb">
			<li>
				<a href="../QuickStart.html">Pages</a>
			</li>
			<li>
				<a href="../Guides.html">Concepts
				</a>
			</li>
			<li>
				<a href="Authentication.html">Authentication
				</a>
			</li>
		</ul>
	</div>
</div>
</header>        <div class="container container-main">
	<div class="row">
		<div class="col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation root">
				<ul>
					<li class=" pp-nav pp-group root">
						<a href="" class="tsd-kind-icon">Pages</a>
					</li>
					<li class=" pp-nav pp-page root">
						<a href="../QuickStart.html" class="tsd-kind-icon">Quick <wbr>Start
						</a>
					</li>
					<li class=" pp-nav pp-page pp-parent pp-active root">
						<a href="../Guides.html" class="tsd-kind-icon">Concepts
						</a>
					</li>
				</ul>
				<ul class="current">
					<li class="current pp-nav pp-page pp-child root">
						<a href="Authentication.html" class="tsd-kind-icon">Authentication
						</a>
					</li>
				</ul>
				<ul class="after-current">
					<li class=" pp-nav pp-page pp-child root">
						<a href="AWS.html" class="tsd-kind-icon">AWS deployment
						</a>
					</li>
					<li class=" pp-nav pp-group root">
						<a href="../../../globals.html" class="tsd-kind-icon">Modules</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_aws.html" class="tsd-kind-icon">@webda/aws</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_core.html" class="tsd-kind-icon">@webda/core</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_elasticsearch.html" class="tsd-kind-icon">@webda/elasticsearch</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_profiler.html" class="tsd-kind-icon">@webda/profiler</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_profiler_aws_xray.html" class="tsd-kind-icon">@webda/profiler-<wbr>aws-<wbr>xray</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_shell.html" class="tsd-kind-icon">@webda/shell</a>
					</li>
					<li class=" tsd-kind-module root">
						<a href="../../../modules/_webda_workout.html" class="tsd-kind-icon">@webda/workout</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
		<div class="col-content">
			<h1>Authentication</h1>
			<div class="tsd-panel tsd-typography">
				<p>The Authentication service highly depends on <a href="http://passportjs.org/">PassportJS</a> this is why its file is passport.js</p>
				<p>It requires two stores : Idents and Users.</p>
				<p>The Idents will contains each mode of Authentication enabled by the user, you will find in the Ident also the profile returned by the OAuth provider if returned.</p>
				<p>The Users will have one object per user, with the idents collection, it also contains the password if any is set.</p>
				<p>Basic configuration</p>
				<pre><code class="language-javascript"><span class="hljs-string">&quot;successRedirect&quot;</span>: <span class="hljs-string">&quot;https://shootandprove.loopingz.com/user.html&quot;</span>, <span class="hljs-comment">// Redirect to this page after login</span>
<span class="hljs-string">&quot;failureRedirect&quot;</span>: <span class="hljs-string">&quot;/login-error&quot;</span>, <span class="hljs-comment">// Redirect to this page after failed login</span>
<span class="hljs-string">&quot;userStore&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// If you want to override the userStore name by default Users</span>
<span class="hljs-string">&quot;identStore&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// If you want to override the identStore name by default Idents</span>
<span class="hljs-string">&quot;providers&quot;</span>: {
  ... <span class="hljs-comment">// See below</span>
}</code></pre>
				<a href="#register-event" id="register-event" style="color: inherit; text-decoration: none;">
					<h2>Register event</h2>
				</a>
				<p>When a user register, the Authentication service send a Register event, so you can complete the user with additional informations.</p>
				<pre><code class="language-javascript"><span class="hljs-comment">// Datas is the profile coming from the OAuth or the Register form</span>
<span class="hljs-built_in">this</span>.emit(<span class="hljs-string">&quot;Register&quot;</span>, { <span class="hljs-attr">user</span>: user, <span class="hljs-attr">datas</span>: datas, <span class="hljs-attr">ctx</span>: ctx });</code></pre>
				<a href="#email-authentication" id="email-authentication" style="color: inherit; text-decoration: none;">
					<h2>Email authentication</h2>
				</a>
				<p>To use this feature you need to have a configured Mailer service, you can define the service name by adding the field mailer inside the email configuration.</p>
				<p>The email authentication has two modes, one that register the user without waiting for the email validation, and the other one that register the user only when the registration form contains the right validation token sent by email.</p>
				<pre><code class="language-javascript">...
<span class="hljs-string">&quot;email&quot;</span>: {
    <span class="hljs-string">&quot;from&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// Email sender</span>
    <span class="hljs-string">&quot;subject&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// Email subject</span>
    <span class="hljs-string">&quot;html&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// HTML to send by email for email validation</span>
    <span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-comment">// Text to send by email for email validation</span>
    <span class="hljs-string">&quot;mailer&quot;</span>: <span class="hljs-string">&quot;DefinedMailer&quot;</span>, <span class="hljs-comment">// Defined mailer to use</span>
    <span class="hljs-string">&quot;postValidation&quot;</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// If true, create user without email validation</span>
    <span class="hljs-string">&quot;skipEmailValidation&quot;</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// Don&#x27;t even send a validation email, must be set along with postValidation=true</span>
},
...</code></pre>
				<p>The email authentication expose
					POST /auth/email
					if the body contains register=true then it will perform registration, if not then only login returning 404 if unknown user, 403 for bad password, 204 for successful login
				GET /auth/callback</p>
				<a href="#oauth" id="oauth" style="color: inherit; text-decoration: none;">
					<h2>OAuth</h2>
				</a>
				<p>You can setup differents types of OAuth, we integrate for now only Facebook, Amazon, Twitter, GitHub, Google.</p>
				<pre><code class="language-javascript">{
  ...
  <span class="hljs-attr">providers</span>: {
    <span class="hljs-attr">facebook</span>: {
      <span class="hljs-attr">clientID</span>: <span class="hljs-string">&quot;facebookClientId&quot;</span>,
      <span class="hljs-attr">clientSecret</span>: <span class="hljs-string">&quot;facebookSecret&quot;</span>,
      <span class="hljs-attr">scope</span>: [<span class="hljs-string">&quot;email&quot;</span>,<span class="hljs-string">&quot;public_profile&quot;</span>]
    }
  }
  ...
}</code></pre>
				<p>This is the same for the other providers, except <strong>Twitter</strong> where the fields are OAuth1 : consumerKey and consumerSecret</p>
			</div>
			<!--{&quot;options&quot;:&quot;/datas/git/webda.io&quot;,&quot;tsconfig&quot;:&quot;/datas/git/webda.io&quot;,&quot;inputFiles&quot;:[&quot;.&quot;],&quot;mode&quot;:1,&quot;includeDeclarations&quot;:false,&quot;entryPoint&quot;:&quot;&quot;,&quot;exclude&quot;:[&quot;**/node_modules&quot;,&quot;packages/*/node_modules&quot;,&quot;packages/*/src/**/*.spec.ts&quot;,&quot;sample-app&quot;],&quot;externalPattern&quot;:[],&quot;excludeExternals&quot;:true,&quot;excludeNotExported&quot;:true,&quot;excludeNotDocumented&quot;:false,&quot;excludePrivate&quot;:true,&quot;excludeProtected&quot;:false,&quot;ignoreCompilerErrors&quot;:true,&quot;disableSources&quot;:false,&quot;includes&quot;:&quot;&quot;,&quot;media&quot;:&quot;&quot;,&quot;out&quot;:&quot;docs/typedoc&quot;,&quot;json&quot;:&quot;&quot;,&quot;theme&quot;:&quot;./node_modules/typedoc-loopingz-theme/bin/default&quot;,&quot;name&quot;:&quot;webda.io&quot;,&quot;includeVersion&quot;:true,&quot;excludeTags&quot;:[],&quot;readme&quot;:&quot;./readme.md&quot;,&quot;defaultCategory&quot;:&quot;Other&quot;,&quot;categoryOrder&quot;:[],&quot;categorizeByGroup&quot;:true,&quot;gitRevision&quot;:&quot;&quot;,&quot;gitRemote&quot;:&quot;origin&quot;,&quot;gaID&quot;:&quot;&quot;,&quot;gaSite&quot;:&quot;auto&quot;,&quot;hideGenerator&quot;:false,&quot;toc&quot;:[],&quot;disableOutputCheck&quot;:false,&quot;help&quot;:false,&quot;version&quot;:false,&quot;plugin&quot;:[],&quot;logger&quot;:&quot;console&quot;,&quot;listInvalidSymbolLinks&quot;:false,&quot;links&quot;:[{&quot;label&quot;:&quot;Guides&quot;,&quot;url&quot;:&quot;/pages/Pages/Guides.html&quot;},{&quot;label&quot;:&quot;GitHub&quot;,&quot;url&quot;:&quot;https://github.com/loopingz/webda.io&quot;}],&quot;outline&quot;:[],&quot;source&quot;:[{&quot;path&quot;:&quot;https://github.com/loopingz/webda.io/blob/master/&quot;,&quot;line&quot;:&quot;L&quot;}],&quot;excludeReferences&quot;:true,&quot;lernaExclude&quot;:[],&quot;pathExclude&quot;:[],&quot;pages&quot;:{&quot;groups&quot;:[{&quot;title&quot;:&quot;Pages&quot;,&quot;source&quot;:&quot;./docs/pages/&quot;,&quot;pages&quot;:[{&quot;title&quot;:&quot;Quick Start&quot;,&quot;source&quot;:&quot;QuickStart.md&quot;},{&quot;title&quot;:&quot;Guides&quot;,&quot;source&quot;:&quot;Guides.md&quot;,&quot;children&quot;:[{&quot;source&quot;:&quot;Authentication.md&quot;},{&quot;source&quot;:&quot;AWS.md&quot;}]}]}],&quot;replaceGlobalsPage&quot;:true,&quot;reflectionNavigationTitle&quot;:&quot;Modules&quot;,&quot;useMarkdownTitle&quot;:true}}-->
			<footer class="with-border-bottom">
			</footer>
			<div class="container tsd-generator">
				<p>Generated using <a href="http://typedoc.org/" target="_blank">TypeDoc</a></p>
			</div>
		</div>
	</div>
</div>
</div>
<div class="overlay"></div>
<script src="../../../assets/js/main.js"></script>
<script
src="https://unpkg.com/mermaid/dist/mermaid.min.js"
></script>
<script>
    mermaid.initialize({
      startOnLoad: true,
    });
    </script>
</body>
</html>